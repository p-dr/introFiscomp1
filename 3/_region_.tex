\message{ !name(relatorio.tex)}\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper, total={19cm, 28cm}]{geometry}
\usepackage{verbatim}
\usepackage{graphicx}


\begin{document}

\message{ !name(relatorio.tex) !offset(-3) }


\section{Derivada numérica}

Neste programa, criou-se  funções FORTRAN para calcular derivadas numéricas da função matemática $f(x)=e^{2x}\sin{x}$. Cada função FORTRAN levava dois argumentos: $x$ e $h$; e retornava o resultado de uma das fórmulas a seguir:

\begin{itemize}
\item Derivada frontal de 2 pontos: \(f_f'(x)={f(x+h)-f(x) \over h}\)
\item Derivada traseira de 2 pontos: \(f_t'(x)={f(x)-f(x-h) \over h}\)
\item Derivada simétrica de 3 pontos: \(f_{3s}'(x)={f(x+h)-f(x-h) \over 2h}\)
\item Derivada simétrica de 5 pontos: \(f_{5s}'(x)={\frac {-f(x+2h)+8f(x+h)-8f(x-h)+f(x-2h)}{12h}}\)
\item Derivada segunda simétrica de 3 pontos: \(f_{3s}''(x)=\frac{f(x+h)-2\,f(x)+f(x-h)}{h^2}\)
\item Derivada segunda simétrica de 5 pontos: \(f_{5s}''(x) ={ -f (x - 2h) + 16f (x - h) - 30f (x) + 16f (x + h) - f (x + 2h)\over 12h^2}\)
\end{itemize}

Todos as variáveis deste programa foram criadas com dupla precisão.
Organizou-se os valores retornados pelas funções criadas, para $x = 1$ e diferentes valores de $h$, nas tabelas \ref{tab:1} e \ref{tab:2}.

\begin{table}[h]
  \centering
  \input{tab1.txt}
  \caption{Derivadas numéricas de $f(x)$ no ponto $x = 1$ por meio de diferentes aproximações em função do passo h.}
  \label{tab:1}
\end{table}

\begin{table}[h]
  \centering
  \input{tab2.txt}
  \caption{Derivadas numéricas de $f (x)$ no ponto $x = 1$ por meio de diferentes aproximações em função do passo h.}
  \label{tab:2}
\end{table}

Em seguida, por meio de métodos não computacionais, chegou-se à real fórmula para a derivada de f(x):
\[f'(x)=e^{2x}(2\sin{x}+\cos{x})\]
e para sua derivada segunda:
\[f''(x)=e^{2x}(3\sin{x}+4\cos{x})\]

Criou-se, a partir dessas últimas duas fórmulas, funções em FORTRAN para calcular o real valor das derivadas de $f(x)$, fazendo uso das funções nativas DEXP, DSIN e DCOS. Os valores reais das derivadas para $x=1$ e diferentes valores de $h$ foram comparados com os retornados pelas funções numéricas, sendo suas diferenças absolutas $|\epsilon|$ apresentadas pelas tabelas \ref{tab:3} e \ref{tab:4}.


\begin{table}[h]
  \centering
  \input{tab3.txt}
  \caption{Valor absoluto dos desvios em relação aos resultados exatos das derivadas numéricas de $f (x)$ no ponto $x = 1$ obtidas por meio de diferentes aproximações em função do passo h.}
  \label{tab:3}
\end{table}

\begin{table}[h]
  \centering
  \input{tab4.txt}
  \caption{Valor absoluto dos desvios em relação aos resultados exatos das derivadas numéricas de $f(x)$ no ponto $x = 1$ obtidas por meio de diferentes aproximações em função do passo h.}
  \label{tab:4}
\end{table}

Observa-se inicialmente que, conforme se diminui $h$, a precisão da aproximação aumenta: os valores das duas primeiras tabelas tendem aos valores esperados para $f'(1)$, 16.427676673177210, e $f''(1)$, 34.622325130868994; ao passo que $|\epsilon|$ mostra-se cada vez menor nas tabelas \ref{tab:3} e \ref{tab:4}.\par
Contudo, após atingir máxima precisão em algum valor de h diferente em cada caso, vê-se que acuidade dos valores começa a se perder, fato que se torna claro pelo posterior aumento de  $|\epsilon|$ nas duas últimas tabelas apresentadas. A célula que porta os valores ótimos de $f'(1)$ ou $f''(1)$ em cada coluna destaca-se em amarelo, bem como os menores valores de $|\epsilon|$.\par
Os valores ótimos de $h$, que geraram menor desvio das aproximações, então são:

\begin{itemize}
\item $f_f'$ e \(f_t'\): Como o posterior aumento de $|\epsilon|$ após queda inicial não foi observado nesses casos, não é possível saber ao certo se o valor de $h$ que gerou o mínimo desvio é, de fato, o valor ótimo. Operações com h menores devem ser realizadas para se determinar isso.
\item \(f_{3s}'\): 9.9999999999999995E-007 e 4.9999999999999998E-007 geraram ambos o mesmo valor de $|\epsilon|$, o menor obtido.
\item \(f_{5s}'\): 1.0000000000000000E-003
\item \(f_{3s}''\):1.0000000000000000E-004
\item \(f_{5s}''\):1.0000000000000000E-003
\end{itemize}

O comportamento constatado de $|\epsilon|$ é facilmente observado ao plotar-se $\log10{|\epsilon|}$ em função do
\message{ !name(relatorio.tex) !offset(-2) }

\end{document}